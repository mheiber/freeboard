# i18n Plan: Expand to 10 Languages + Auto-detect + Globe Icon

## Languages (top 10 by speakers)

| Case | Language   | Native Name | Needs system font? |
|------|-----------|-------------|-------------------|
| `en` | English    | English     | No (Menlo)        |
| `zh` | Chinese    | 中文        | Yes               |
| `hi` | Hindi      | हिन्दी       | Yes               |
| `es` | Spanish    | Español     | No (Menlo)        |
| `fr` | French     | Français    | No (Menlo)        |
| `ar` | Arabic     | العربية      | Yes               |
| `bn` | Bengali    | বাংলা       | Yes               |
| `pt` | Portuguese | Português   | No (Menlo)        |
| `ru` | Russian    | Русский     | No (Menlo)        |
| `ja` | Japanese   | 日本語      | Yes               |

## Files to Modify

1. `Freeboard/Localization.swift` — core i18n changes
2. `Freeboard/AppDelegate.swift` — menu refactor + globe icon
3. `Freeboard/ClipboardHistoryViewController.swift` — font generalization
4. `FreeboardTests/EmptyStateTests.swift` — expanded tests

---

## Step 1: `Localization.swift` — Expand Lang enum

```swift
enum Lang: String, CaseIterable {
    case en, zh, hi, es, fr, ar, bn, pt, ru, ja

    var nativeName: String {
        switch self {
        case .en: return "English"
        case .zh: return "中文"
        case .hi: return "हिन्दी"
        case .es: return "Español"
        case .fr: return "Français"
        case .ar: return "العربية"
        case .bn: return "বাংলা"
        case .pt: return "Português"
        case .ru: return "Русский"
        case .ja: return "日本語"
        }
    }

    var usesSystemFont: Bool {
        switch self {
        case .zh, .ja, .hi, .ar, .bn: return true
        case .en, .es, .fr, .pt, .ru: return false
        }
    }

    static func fromLocaleIdentifier(_ identifier: String) -> Lang? {
        let prefix = String(identifier.prefix(2)).lowercased()
        return Lang(rawValue: prefix)
    }
}
```

## Step 2: `Localization.swift` — Refactor L struct

- Auto-detect from system locale when no UserDefaults key exists
- Dictionary-based `tr()` lookup with English fallback
- Remove `L.english`, `L.chinese`; add `L.language`

```swift
struct L {
    private static let langKey = "freeboard_language"

    static var current: Lang {
        get {
            if let raw = UserDefaults.standard.string(forKey: langKey),
               let lang = Lang(rawValue: raw) {
                return lang
            }
            // Auto-detect from system locale
            for id in Locale.preferredLanguages {
                if let lang = Lang.fromLocaleIdentifier(id) {
                    return lang
                }
            }
            return .en
        }
        set {
            UserDefaults.standard.set(newValue.rawValue, forKey: langKey)
        }
    }

    private static func tr(_ key: String) -> String {
        strings[key]?[current] ?? strings[key]?[.en] ?? key
    }

    // All string accessors via tr()
    static var open: String { tr("open") }
    // ... etc for all keys
}
```

## Step 3: `AppDelegate.swift` — Menu refactor

- Delete `switchToEnglish()`, `switchToChinese()`
- Add generic `switchLanguage(_ sender: NSMenuItem)` using `sender.representedObject as? Lang`
- Build language menu with `Lang.allCases` loop
- Add globe SF Symbol: `langItem.image = NSImage(systemSymbolName: "globe", accessibilityDescription: "Language")`
- Use `L.language` for menu title

## Step 4: `ClipboardHistoryViewController.swift` — Font generalization

Three mechanical replacements of `L.current == .zh` → `L.current.usesSystemFont`:
- `retroFont` (line 39)
- `retroFontSmall` (line 45)
- `updateEmptyStateVisibility()` large font (line 373)

## Step 5: Tests — Expand `EmptyStateTests.swift`

- Add test for a third language to verify dictionary lookup
- Add test for `Lang.usesSystemFont`
- Add test for `Lang.nativeName`
- Add test for auto-detect fallback

---

## Expert-Validated Translations

All translations below were reviewed by language-specific experts for idiomatic correctness in software UI contexts.

### English (en) — baseline
```
open: "Open"
shortcut: "Shortcut"
searchPlaceholder: "▌ Search clipboard history..."
navigate: "navigate"
paste: "paste"
close: "close"
expand: "expand"
edit: "edit"
star: "star"
quit: "Quit"
quitFreeboard: "Quit Freeboard"
justNow: "just now"
emptyHint: "Text you copy will show up here"
openClose: "open/close"
quickSelect: "quick select"
noMatchesFound: "No matches found."
clearSearch: "Clear Search (Esc)"
language: "Language"
minutesAgo: "%dm ago"
hoursAgo: "%dh ago"
daysAgo: "%dd ago"
```

### Chinese (zh) — existing, verified
```
open: "打开"
shortcut: "快捷键"
searchPlaceholder: "▌ 搜索剪贴板历史..."
navigate: "导航"
paste: "粘贴"
close: "关闭"
expand: "展开"
edit: "编辑"
star: "收藏"
quit: "退出"
quitFreeboard: "退出 Freeboard"
justNow: "刚刚"
emptyHint: "复制的文本将显示在这里"
openClose: "打开/关闭此窗口"
quickSelect: "快速选择"
noMatchesFound: "未找到匹配项。"
clearSearch: "清除搜索 (Esc)"
language: "语言"
minutesAgo: "%d分钟前"
hoursAgo: "%d小时前"
daysAgo: "%d天前"
```

### Hindi (hi) — expert-validated
```
open: "खोलें"
shortcut: "शॉर्टकट"
searchPlaceholder: "▌ क्लिपबोर्ड हिस्ट्री खोजें..."
navigate: "नेविगेट करें"
paste: "पेस्ट करें"
close: "बंद करें"
expand: "विस्तार करें"
edit: "संपादित करें"
star: "स्टार करें"
quit: "छोड़ें"
quitFreeboard: "Freeboard छोड़ें"
justNow: "अभी"
emptyHint: "कॉपी किया गया टेक्स्ट यहाँ दिखेगा"
openClose: "खोलें/बंद करें"
quickSelect: "त्वरित चयन"
noMatchesFound: "कोई मिलान नहीं मिला।"
clearSearch: "खोज साफ़ करें (Esc)"
language: "भाषा"
minutesAgo: "%d मि॰ पहले"
hoursAgo: "%d घं॰ पहले"
daysAgo: "%d दिन पहले"
```

Expert notes: "हिस्ट्री" preferred over formal "इतिहास" in tech contexts. Verb forms need "करें" suffix for action labels. "छोड़ें" is correct for Quit (not "बंद करें" which means Close).

### Spanish (es) — expert-validated
```
open: "Abrir"
shortcut: "Atajo"
searchPlaceholder: "▌ Buscar en historial..."
navigate: "navegar"
paste: "pegar"
close: "cerrar"
expand: "ampliar"
edit: "editar"
star: "destacar"
quit: "Salir"
quitFreeboard: "Salir de Freeboard"
justNow: "ahora mismo"
emptyHint: "El texto que copies aparecerá aquí"
openClose: "abrir/cerrar"
quickSelect: "selección rápida"
noMatchesFound: "No se encontraron coincidencias."
clearSearch: "Limpiar búsqueda (Esc)"
language: "Idioma"
minutesAgo: "hace %dm"
hoursAgo: "hace %dh"
daysAgo: "hace %dd"
```

Expert notes: "ampliar" is macOS standard for expand. "destacar" works for star action. "Limpiar" preferred over "Borrar" for UI reset.

### French (fr) — expert-validated
```
open: "Ouvrir"
shortcut: "Raccourci"
searchPlaceholder: "▌ Rechercher dans l'historique du presse-papiers..."
navigate: "naviguer"
paste: "coller"
close: "fermer"
expand: "étendre"
edit: "modifier"
star: "favori"
quit: "Quitter"
quitFreeboard: "Quitter Freeboard"
justNow: "à l'instant"
emptyHint: "Le texte copié apparaîtra ici"
openClose: "ouvrir/fermer"
quickSelect: "sélection rapide"
noMatchesFound: "Aucun résultat trouvé."
clearSearch: "Effacer la recherche (Esc)"
language: "Langue"
minutesAgo: "il y a %d min"
hoursAgo: "il y a %d h"
daysAgo: "il y a %d j"
```

Expert notes: "étendre" preferred over "développer" (which means "develop" in software contexts). "presse-papiers" is standard French for clipboard.

### Arabic (ar) — expert-validated
```
open: "فتح"
shortcut: "اختصار"
searchPlaceholder: "▌ ابحث في سجل الحافظة..."
navigate: "التنقل"
paste: "لصق"
close: "إغلاق"
expand: "توسيع"
edit: "تحرير"
star: "تمييز"
quit: "إنهاء"
quitFreeboard: "إنهاء Freeboard"
justNow: "الآن"
emptyHint: "سيظهر النص المنسوخ هنا"
openClose: "فتح/إغلاق"
quickSelect: "اختيار سريع"
noMatchesFound: "لا توجد نتائج."
clearSearch: "مسح البحث (Esc)"
language: "اللغة"
minutesAgo: "منذ %d د"
hoursAgo: "منذ %d س"
daysAgo: "منذ %d ي"
```

Expert notes: Search placeholder uses imperative "ابحث" (more natural for placeholders). "تمييز" for star (mark/distinguish). "لا توجد نتائج" is more concise than formal alternative.

### Bengali (bn) — expert-validated
```
open: "খুলুন"
shortcut: "শর্টকাট"
searchPlaceholder: "▌ ক্লিপবোর্ড ইতিহাস অনুসন্ধান..."
navigate: "নেভিগেট"
paste: "পেস্ট"
close: "বন্ধ"
expand: "প্রসারিত"
edit: "সম্পাদনা"
star: "তারকা"
quit: "প্রস্থান"
quitFreeboard: "Freeboard বন্ধ করুন"
justNow: "এইমাত্র"
emptyHint: "কপি করা টেক্সট এখানে দেখা যাবে"
openClose: "খুলুন/বন্ধ"
quickSelect: "দ্রুত নির্বাচন"
noMatchesFound: "কোনো মিল পাওয়া যায়নি।"
clearSearch: "অনুসন্ধান মুছুন (Esc)"
language: "ভাষা"
minutesAgo: "%d মিনিট আগে"
hoursAgo: "%d ঘণ্টা আগে"
daysAgo: "%d দিন আগে"
```

Expert notes: quitFreeboard uses "বন্ধ করুন" for more natural word order. Loanwords (শর্টকাট, পেস্ট, নেভিগেট) are standard in Bengali tech UIs.

### Portuguese (pt) — expert-validated, Brazilian Portuguese
```
open: "Abrir"
shortcut: "Atalho"
searchPlaceholder: "▌ Pesquisar histórico..."
navigate: "navegar"
paste: "colar"
close: "fechar"
expand: "expandir"
edit: "editar"
star: "favoritar"
quit: "Sair"
quitFreeboard: "Sair do Freeboard"
justNow: "agora mesmo"
emptyHint: "O texto copiado aparecerá aqui"
openClose: "abrir/fechar"
quickSelect: "seleção rápida"
noMatchesFound: "Nenhum resultado encontrado."
clearSearch: "Limpar pesquisa (Esc)"
language: "Idioma"
minutesAgo: "há %d min"
hoursAgo: "há %d h"
daysAgo: "há %d d"
```

Expert notes: "favoritar" as verb form for star action. Shortened search placeholder for UI space. "Nenhum resultado" is more natural than "Nenhuma correspondência".

### Russian (ru) — expert-validated
```
open: "Открыть"
shortcut: "Сочетание клавиш"
searchPlaceholder: "▌ Поиск в буфере обмена..."
navigate: "переход"
paste: "вставить"
close: "закрыть"
expand: "развернуть"
edit: "править"
star: "отметить"
quit: "Выход"
quitFreeboard: "Выйти из Freeboard"
justNow: "только что"
emptyHint: "Скопированный текст появится здесь"
openClose: "открыть/закрыть"
quickSelect: "быстрый выбор"
noMatchesFound: "Совпадений не найдено."
clearSearch: "Очистить поиск (Esc)"
language: "Язык"
minutesAgo: "%d мин"
hoursAgo: "%d ч"
daysAgo: "%d д"
```

Expert notes: "Сочетание клавиш" is macOS standard for Shortcut. "переход" more natural than "навигация" for keyboard nav hints. "править" more concise than "редактировать". Time labels omit "назад" (ago) — standard in Russian UIs for compact displays.

### Japanese (ja) — expert-validated
```
open: "開く"
shortcut: "ショートカット"
searchPlaceholder: "▌ クリップボード履歴を検索..."
navigate: "移動"
paste: "貼り付け"
close: "閉じる"
expand: "展開"
edit: "編集"
star: "スター"
quit: "終了"
quitFreeboard: "Freeboard を終了"
justNow: "今"
emptyHint: "コピーしたテキストがここに表示されます"
openClose: "開く/閉じる"
quickSelect: "クイック選択"
noMatchesFound: "一致する項目がありません"
clearSearch: "検索をクリア (Esc)"
language: "言語"
minutesAgo: "%d分前"
hoursAgo: "%d時間前"
daysAgo: "%d日前"
```

Expert notes: "貼り付け" is Apple's standard (not "ペースト"). "スター" more concise than "お気に入り" for action label. "今" preferred over "たった今" for UI compactness. No period on "一致する項目がありません" — Japanese UI convention.

---

## Verification

1. `xcodebuild build` — confirm compilation
2. `xcodebuild test` — confirm all tests pass
3. Manual: right-click [F] menu → verify globe icon, 10 languages listed with native names, checkmark on current
4. Manual: select non-English language → verify all UI strings update
5. Manual: delete `freeboard_language` from UserDefaults, relaunch → verify auto-detection matches system locale
